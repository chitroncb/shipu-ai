module.exports = {
  config: {
    name: "allist",
    aliases: [],
    author: "Chitron Bhattacharjee ğŸâœ¨",
    version: "2.0",
    cooldowns: 5,
    role: 2,
    shortDescription: {
      en: "List all group chats the bot is in."
    },
    longDescription: {
      en: "Use this command to list all group chats the bot is currently a member of."
    },
    category: "owner",
    guide: {
      en: "{p}{n}"
    }
  },

  onStart: async function ({ api, event }) {
    try {
      const groupList = await api.getThreadList(100, null, ['INBOX']);
      const filteredList = groupList.filter(group => group.threadName);

      if (filteredList.length === 0) {
        return api.sendMessage("âŒ ğ“ğ“¸ ğ“°ğ“»ğ“¸ğ“¾ğ“¹ ğ“¬ğ“±ğ“ªğ“½ğ“¼ ğ’‡ğ“¸ğ“¾ğ“·ğ“­ ğ“²ğ“· ğ“½ğ“±ğ“® ğ“«ğ“¸ğ“½'ğ“¼ ğ“²ğ“·ğ“¿ğ“¸ğ“µğ“¿ğ“®ğ“­ ğ“µğ“²ğ“¼ğ“½.", event.threadID);
      }

      const formattedList = filteredList.map((group, index) =>
        `â”‚ ${index + 1}. ${group.threadName}\nâ”‚ ğ“ğ‡ğ‘ğ„ğ€ğƒ ğˆğƒ: ${group.threadID}`
      );

      const message = [
        "â•­â”€â”€â”€â•®",
        "â”‚ ğŸ“‹ ğ“›ğ“²ğ“¼ğ“½ ğ“¸ğ“¯ ğ“ğ“µğ“µ ğ“–ğ“»ğ“¸ğ“¾ğ“¹ ğ“’ğ“±ğ“ªğ“½ğ“¼:",
        ...formattedList,
        "â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ê”ª"
      ].join("\n");

      await api.sendMessage(message, event.threadID, event.messageID);
    } catch (error) {
      console.error("âŒ Error listing group chats:", error);
      await api.sendMessage("âš ï¸ ğ“•ğ“ªğ“²ğ“µğ“®ğ“­ ğ“½ğ“¸ ğ“»ğ“®ğ“½ğ“»ğ“²ğ“®ğ“¿ğ“® ğ“°ğ“»ğ“¸ğ“¾ğ“¹ ğ“¬ğ“±ğ“ªğ“½ ğ“µğ“²ğ“¼ğ“½.", event.threadID);
    }
  }
};